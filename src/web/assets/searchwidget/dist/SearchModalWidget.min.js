var SearchModalWidget=(()=>{var E=Object.defineProperty;var ve=Object.getOwnPropertyDescriptor;var ye=Object.getOwnPropertyNames;var we=Object.prototype.hasOwnProperty;var Ce=(t,e)=>{for(var n in e)E(t,n,{get:e[n],enumerable:!0})},Se=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ye(e))!we.call(t,o)&&o!==n&&E(t,o,{get:()=>e[o],enumerable:!(r=ve(e,o))||r.enumerable});return t};var Te=t=>Se(E({},"__esModule",{value:!0}),t);var We={};Ce(We,{default:()=>qe});var Ae={indices:[],placeholder:"Search...",theme:"light",maxResults:10,debounce:200,minChars:2,showRecent:!0,maxRecentSearches:5,groupResults:!0,siteId:"",searchEndpoint:"/actions/search-manager/search/query",trackClickEndpoint:"/actions/search-manager/search/track-click",trackSearchEndpoint:"/actions/search-manager/search/track-search",idleTimeout:1500,source:"",enableHighlighting:!0,highlightTag:"mark",highlightClass:"",hideResultsWithoutUrl:!1,showLoadingIndicator:!0,debug:!1,styles:{},promotions:{showBadge:!0,badgeText:"Featured",badgePosition:"top-right"}},Re={hotkey:"k",showTrigger:!0,triggerSelector:"",backdropOpacity:50,enableBackdropBlur:!0,preventBodyScroll:!0},Ee={showFilters:!0,paginationType:"numbered",resultsPerPage:20,updateUrl:!0,sortOptions:["relevance","date-desc","date-asc","title"]},De={dropdownPosition:"below",dropdownMaxHeight:400,showOnFocus:!0};function Be(t){return{...Ae,...{modal:Re,page:Ee,inline:De}[t]||{}}}function h(t,e=!1){return t==null?e:t===""?!0:t!=="false"&&t!=="0"}function b(t,e=0){if(t==null)return e;let n=Number.parseInt(t,10);return Number.isNaN(n)?e:n}function z(t,e={}){if(!t)return e;try{return JSON.parse(t)}catch(n){return console.warn("SearchWidget: Invalid JSON attribute",n),e}}function q(t){return t?t.split(",").map(e=>e.trim()).filter(Boolean):[]}function D(t,e="modal"){let n=Be(e),r=t.getAttribute("indices")||"",o=q(r),a={indices:o,index:o[0]||"",placeholder:t.getAttribute("placeholder")||n.placeholder,theme:t.getAttribute("theme")||n.theme,siteId:t.getAttribute("site-id")||n.siteId,source:t.getAttribute("source")||n.source,highlightTag:t.getAttribute("highlight-tag")||n.highlightTag,highlightClass:t.getAttribute("highlight-class")||n.highlightClass,searchEndpoint:n.searchEndpoint,trackClickEndpoint:n.trackClickEndpoint,trackSearchEndpoint:n.trackSearchEndpoint,maxResults:b(t.getAttribute("max-results"),n.maxResults),debounce:b(t.getAttribute("debounce"),n.debounce),minChars:b(t.getAttribute("min-chars"),n.minChars),maxRecentSearches:b(t.getAttribute("max-recent-searches"),n.maxRecentSearches),idleTimeout:b(t.getAttribute("idle-timeout"),n.idleTimeout),showRecent:h(t.getAttribute("show-recent"),n.showRecent),groupResults:h(t.getAttribute("group-results"),n.groupResults),enableHighlighting:h(t.getAttribute("enable-highlighting"),n.enableHighlighting),showLoadingIndicator:h(t.getAttribute("show-loading-indicator"),n.showLoadingIndicator),hideResultsWithoutUrl:h(t.getAttribute("hide-results-without-url"),n.hideResultsWithoutUrl),debug:h(t.getAttribute("debug"),n.debug),styles:z(t.getAttribute("styles"),n.styles),promotions:z(t.getAttribute("promotions"),n.promotions)};return e==="modal"&&Object.assign(a,{hotkey:t.getAttribute("hotkey")||n.hotkey,triggerSelector:t.getAttribute("trigger-selector")||n.triggerSelector,backdropOpacity:b(t.getAttribute("backdrop-opacity"),n.backdropOpacity),showTrigger:h(t.getAttribute("show-trigger"),n.showTrigger),enableBackdropBlur:h(t.getAttribute("enable-backdrop-blur"),n.enableBackdropBlur),preventBodyScroll:h(t.getAttribute("prevent-body-scroll"),n.preventBodyScroll)}),e==="page"&&Object.assign(a,{resultsPerPage:b(t.getAttribute("results-per-page"),n.resultsPerPage),paginationType:t.getAttribute("pagination-type")||n.paginationType,showFilters:h(t.getAttribute("show-filters"),n.showFilters),updateUrl:h(t.getAttribute("update-url"),n.updateUrl),sortOptions:q(t.getAttribute("sort-options"))||n.sortOptions}),e==="inline"&&Object.assign(a,{dropdownPosition:t.getAttribute("dropdown-position")||n.dropdownPosition,dropdownMaxHeight:b(t.getAttribute("dropdown-max-height"),n.dropdownMaxHeight),showOnFocus:h(t.getAttribute("show-on-focus"),n.showOnFocus)}),a}function W(t="modal"){let e=["indices","placeholder","theme","max-results","debounce","min-chars","show-recent","max-recent-searches","group-results","site-id","idle-timeout","source","enable-highlighting","highlight-tag","highlight-class","hide-results-without-url","show-loading-indicator","debug","styles","promotions"],a={modal:["hotkey","show-trigger","trigger-selector","backdrop-opacity","enable-backdrop-blur","prevent-body-scroll"],page:["show-filters","pagination-type","results-per-page","update-url","sort-options"],inline:["dropdown-position","dropdown-max-height","show-on-focus"]};return[...e,...a[t]||[]]}var S={isOpen:!1,query:"",results:[],recentSearches:[],selectedIndex:-1,loading:!1,error:null,meta:null};function _(t={},e=null){let n={...S,...t};return{get(r){return n[r]},getAll(){return{...n}},set(r){let o=[];return Object.keys(r).forEach(a=>{let s=n[a],l=r[a];T(s,l)||o.push(a)}),o.length>0&&(n={...n,...r},e&&e(n,o)),o},reset(r=t){let o={...S,...r},a=Object.keys(o).filter(s=>!T(n[s],o[s]));a.length>0&&(n=o,e&&e(n,a))},is(r,o){return n[r]===o},toggle(r){let o=!n[r];return this.set({[r]:o}),o}}}function T(t,e){if(t===e)return!0;if(t==null||e==null)return!1;if(Array.isArray(t)&&Array.isArray(e))return t.length!==e.length?!1:t.every((n,r)=>T(n,e[r]));if(typeof t=="object"&&typeof e=="object"){let n=Object.keys(t),r=Object.keys(e);return n.length!==r.length?!1:n.every(o=>T(t[o],e[o]))}return!1}async function G({query:t,endpoint:e,indices:n=[],siteId:r="",maxResults:o=10,hideResultsWithoutUrl:a=!1,debug:s=!1,signal:l}){let i=new URLSearchParams({q:t,limit:o.toString()});n.length>0&&i.append("indices",n.join(",")),r&&i.append("siteId",r),a&&i.append("hideResultsWithoutUrl","1"),s&&i.append("debug","1"),i.append("skipAnalytics","1");let d=e.includes("?")?"&":"?",g=await fetch(`${e}${d}${i}`,{signal:l,headers:{Accept:"application/json"}});if(!g.ok)throw new Error("Search failed");let u=await g.json();return u.error&&console.warn("Search warning:",u.error),{results:u.results||u.hits||[],total:u.total||0,meta:u.meta||null,error:u.error||null}}function K({endpoint:t,elementId:e,query:n,index:r}){if(!(!e||!t))try{let o=new FormData;o.append("elementId",e),o.append("query",n),o.append("index",r),fetch(t,{method:"POST",body:o}).catch(()=>{})}catch{}}function V({endpoint:t,query:e,indices:n=[],resultsCount:r=0,trigger:o="unknown",source:a="",siteId:s=""}){if(!(!e||!t))try{let l=new FormData;l.append("q",e),l.append("indices",n.join(",")),l.append("resultsCount",r.toString()),l.append("trigger",o),l.append("source",a||"frontend-widget"),s&&l.append("siteId",s),fetch(t,{method:"POST",body:l}).catch(()=>{})}catch{}}function Y(t){let e={};return t.forEach(n=>{let r=n.section||n.type||"Results";e[r]||(e[r]=[]),e[r].push(n)}),e}var Ie="sm-recent-";function B(t){return`${Ie}${t||"default"}`}function A(t){try{let e=B(t),n=localStorage.getItem(e);return n?JSON.parse(n):[]}catch{return[]}}function Q(t,e,n=null,r=5){if(!e||!e.trim())return A(t);let o=B(t),a={query:e.trim(),title:n?.title||e,url:n?.url||null,timestamp:Date.now()},s=A(t);s=s.filter(l=>l.query!==a.query),s.unshift(a),s=s.slice(0,r);try{localStorage.setItem(o,JSON.stringify(s))}catch{}return s}function X(t){try{let e=B(t);localStorage.removeItem(e)}catch{}}var J={spinnerColor:"#3b82f6",spinnerColorDark:"#60a5fa",modalBg:"#ffffff",modalBgDark:"#1f2937",modalBorderRadius:"12",modalBorderWidth:"1",modalBorderColor:"#e5e7eb",modalBorderColorDark:"#374151",modalShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",modalShadowDark:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",modalMaxWidth:"640",modalMaxHeight:"80",inputBg:"#ffffff",inputBgDark:"#1f2937",inputTextColor:"#111827",inputTextColorDark:"#f9fafb",inputPlaceholderColor:"#9ca3af",inputPlaceholderColorDark:"#9ca3af",inputBorderColor:"#e5e7eb",inputBorderColorDark:"#374151",inputFontSize:"16",resultBg:"transparent",resultBgDark:"transparent",resultHoverBg:"#f3f4f6",resultHoverBgDark:"#374151",resultActiveBg:"#e5e7eb",resultActiveBgDark:"#4b5563",resultTextColor:"#111827",resultTextColorDark:"#f9fafb",resultDescColor:"#4b5563",resultDescColorDark:"#d1d5db",resultMutedColor:"#6b7280",resultMutedColorDark:"#d1d5db",resultBorderRadius:"8",triggerBg:"#ffffff",triggerBgDark:"#374151",triggerTextColor:"#374151",triggerTextColorDark:"#d1d5db",triggerBorderRadius:"8",triggerBorderWidth:"1",triggerBorderColor:"#d1d5db",triggerBorderColorDark:"#4b5563",triggerPaddingX:"12",triggerPaddingY:"8",triggerFontSize:"14",kbdBg:"#f3f4f6",kbdBgDark:"#4b5563",kbdTextColor:"#4b5563",kbdTextColorDark:"#e5e7eb",kbdBorderRadius:"4"};var Z={modalBg:"--sm-modal-bg",modalBgDark:"--sm-modal-bg-dark",modalBorderRadius:"--sm-modal-radius",modalBorderWidth:"--sm-modal-border-width",modalBorderColor:"--sm-modal-border-color",modalBorderColorDark:"--sm-modal-border-color-dark",modalShadow:"--sm-modal-shadow",modalShadowDark:"--sm-modal-shadow-dark",modalMaxWidth:"--sm-modal-width",modalMaxHeight:"--sm-modal-max-height",inputBg:"--sm-input-bg",inputBgDark:"--sm-input-bg-dark",inputTextColor:"--sm-input-color",inputTextColorDark:"--sm-input-color-dark",inputPlaceholderColor:"--sm-input-placeholder",inputPlaceholderColorDark:"--sm-input-placeholder-dark",inputBorderColor:"--sm-input-border-color",inputBorderColorDark:"--sm-input-border-color-dark",inputFontSize:"--sm-input-font-size",resultBg:"--sm-result-bg",resultBgDark:"--sm-result-bg-dark",resultHoverBg:"--sm-result-hover-bg",resultHoverBgDark:"--sm-result-hover-bg-dark",resultActiveBg:"--sm-result-active-bg",resultActiveBgDark:"--sm-result-active-bg-dark",resultTextColor:"--sm-result-text-color",resultTextColorDark:"--sm-result-text-color-dark",resultDescColor:"--sm-result-desc-color",resultDescColorDark:"--sm-result-desc-color-dark",resultMutedColor:"--sm-result-muted-color",resultMutedColorDark:"--sm-result-muted-color-dark",resultBorderRadius:"--sm-result-radius",triggerBg:"--sm-trigger-bg",triggerBgDark:"--sm-trigger-bg-dark",triggerTextColor:"--sm-trigger-text-color",triggerTextColorDark:"--sm-trigger-text-color-dark",triggerBorderRadius:"--sm-trigger-radius",triggerBorderWidth:"--sm-trigger-border-width",triggerBorderColor:"--sm-trigger-border-color",triggerBorderColorDark:"--sm-trigger-border-color-dark",triggerPaddingX:"--sm-trigger-px",triggerPaddingY:"--sm-trigger-py",triggerFontSize:"--sm-trigger-font-size",kbdBg:"--sm-kbd-bg",kbdBgDark:"--sm-kbd-bg-dark",kbdTextColor:"--sm-kbd-text-color",kbdTextColorDark:"--sm-kbd-text-color-dark",kbdBorderRadius:"--sm-kbd-radius",highlightBgLight:"--sm-highlight-bg",highlightColorLight:"--sm-highlight-color",highlightBgDark:"--sm-highlight-bg-dark",highlightColorDark:"--sm-highlight-color-dark",spinnerColor:"--sm-spinner-color-light",spinnerColorDark:"--sm-spinner-color-dark"},ee=["modalBorderRadius","modalBorderWidth","modalMaxWidth","inputFontSize","resultBorderRadius","triggerBorderRadius","triggerBorderWidth","triggerPaddingX","triggerPaddingY","triggerFontSize","kbdBorderRadius"],te=["modalMaxHeight"],ne=["modalBg","modalBgDark","modalBorderColor","modalBorderColorDark","inputBg","inputBgDark","inputTextColor","inputTextColorDark","inputPlaceholderColor","inputPlaceholderColorDark","inputBorderColor","inputBorderColorDark","resultBg","resultBgDark","resultHoverBg","resultHoverBgDark","resultActiveBg","resultActiveBgDark","resultTextColor","resultTextColorDark","resultDescColor","resultDescColorDark","resultMutedColor","resultMutedColorDark","triggerBg","triggerBgDark","triggerTextColor","triggerTextColorDark","triggerBorderColor","triggerBorderColorDark","kbdBg","kbdBgDark","kbdTextColor","kbdTextColorDark","highlightBgLight","highlightColorLight","highlightBgDark","highlightColorDark","spinnerColor","spinnerColorDark"],Je={...J,highlightBgLight:"#fef08a",highlightColorLight:"#854d0e",highlightBgDark:"#854d0e",highlightColorDark:"#fef08a"};function $e(t){return/^[0-9a-fA-F]{6}$/.test(t)}function Me(t,e){if(e==null||e==="")return null;let n=String(e);return ne.includes(t)&&$e(n)&&(n="#"+n),ee.includes(t)&&(n=n+"px"),te.includes(t)&&(n=n+"vh"),n}function re(t,e,n="light"){if(!e||typeof e!="object")return;let r=n==="dark";for(let[o,a]of Object.entries(Z)){let s=o.endsWith("Dark");if(!(r&&!s)&&!(!r&&s)&&e[o]!==void 0&&e[o]!==null&&e[o]!==""){let l=Me(o,e[o]);l&&t.style.setProperty(a,l)}}}function c(t){if(!t)return"";let e=document.createElement("div");return e.textContent=t,e.innerHTML}function Oe(t){return t?t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):""}function I(t,e,n={}){let{enabled:r=!0,tag:o="mark",className:a=""}=n,s=c(t);if(!r||!e)return s;let l=e.toLowerCase().split(/\s+/).filter(u=>u.length>0);if(l.length===0)return s;let i=["sm-highlight"];a&&i.push(a);let d=` class="${i.join(" ")}"`,g=s;return l.forEach(u=>{let f=new RegExp(`\\b(${Oe(u)})\\b`,"gi");g=g.replace(f,`<${o}${d}>$1</${o}>`)}),g}var Pe=0;function L(t="sm"){return`${t}-${++Pe}-${Date.now().toString(36)}`}function oe(t){let e=document.createElement("div");return e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.className="sm-sr-only",t.appendChild(e),e}function v(t,e,n=100){t&&(t.textContent="",setTimeout(()=>{t.textContent=e},n))}function $(t,e){return t===0?`No results found for "${e}"`:t===1?`1 result found for "${e}"`:`${t} results found for "${e}"`}function ae(){return"Searching..."}function se(t){return t===0?"No recent searches":t===1?"1 recent search available":`${t} recent searches available`}function R(t,{expanded:e,activeDescendant:n,listboxId:r}){t.setAttribute("aria-expanded",String(e)),t.setAttribute("aria-controls",r),n?t.setAttribute("aria-activedescendant",n):t.removeAttribute("aria-activedescendant")}function y(t,e){return`${t}-option-${e}`}function ie(t,e){if(!t||!e)return;let n=t.getBoundingClientRect(),r=e.getBoundingClientRect();n.top<r.top?t.scrollIntoView({block:"nearest",behavior:"smooth"}):n.bottom>r.bottom&&t.scrollIntoView({block:"nearest",behavior:"smooth"})}function He(t,e,n={}){let{groupResults:r=!1,listboxId:o}=n;if(!t||t.length===0)return"";if(r){let a=Y(t),s=0;return Object.entries(a).map(([l,i])=>`
            <div class="sm-section" role="group" aria-label="${c(l)}">
                <div class="sm-section-header">${c(l)}</div>
                ${i.map(d=>le(d,s++,e,n)).join("")}
            </div>
        `).join("")}return t.map((a,s)=>le(a,s,e,n)).join("")}function le(t,e,n,r={}){let{listboxId:o,enableHighlighting:a=!0,highlightTag:s="mark",highlightClass:l="",groupResults:i=!1,promotions:d={},debug:g=!1}=r,u=t.title||t.name||"Untitled",f=t.description||t.excerpt||t.snippet||"",k=t.url||t.href||"#",x=t.section||t.type||"",w=y(o,e),ke=t.promoted===!0,H={enabled:a,tag:s,className:l},F=I(u,n,H),C=f?I(f,n,H):"",N=Ne(t,d),U=ke?" sm-promoted":"",j=x&&!i?`<span class="sm-result-type">${c(x)}</span>`:"",xe=g?Fe(t):"";return g?`
            <a class="sm-result-item sm-debug-enabled${U}" id="${w}" role="option" aria-selected="false" href="${c(k)}" data-index="${e}" data-id="${t.id||""}" data-title="${c(u)}">
                <div class="sm-result-main">
                    ${N}
                    <div class="sm-result-content">
                        <span class="sm-result-title">${F}</span>
                        ${C?`<span class="sm-result-desc">${C}</span>`:""}
                    </div>
                    ${j}
                    <svg class="sm-result-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </div>
                ${xe}
            </a>
        `:`
        <a class="sm-result-item${U}" id="${w}" role="option" aria-selected="false" href="${c(k)}" data-index="${e}" data-id="${t.id||""}" data-title="${c(u)}">
            ${N}
            <div class="sm-result-content">
                <span class="sm-result-title">${F}</span>
                ${C?`<span class="sm-result-desc">${C}</span>`:""}
            </div>
            ${j}
            <svg class="sm-result-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
        </a>
    `}function Fe(t){let e=[],n=t.backend?t.backend.toLowerCase():"";if((t._index||t.index)&&e.push(p("index",t._index||t.index,"index")),t.backend&&e.push(p("backend",n,"backend",n)),t.id&&e.push(p("id",t.id,"generic")),t.score!==void 0&&t.score!==null){let r=typeof t.score=="number"?t.score.toFixed(2):t.score;e.push(p("score",r,"score"))}if(t.site&&e.push(p("site",t.site,"generic")),t.language&&e.push(p("lang",t.language,"generic")),t.matchedIn&&Array.isArray(t.matchedIn)&&t.matchedIn.length>0){let r=t.matchedIn.join(", ");e.push(p("matched",r,"matched"))}return t.promoted&&e.push(p("promoted","yes","promoted")),t.boosted&&e.push(p("boosted","yes","boosted")),e.length===0?"":`<div class="sm-debug-info">${e.join("")}</div>`}function p(t,e,n,r=""){let o=r?` data-backend="${c(r)}"`:"";return`<span class="sm-debug-item"><span class="sm-debug-label">${c(t)}</span><span class="sm-debug-value" data-type="${c(n)}"${o}>${c(String(e))}</span></span>`}function Ne(t,e={}){let{showBadge:n=!0,badgeText:r="Featured",badgePosition:o="top-right"}=e;return!t.promoted||!n?"":`<span class="sm-promoted-badge ${`sm-promoted-badge--${o}`}">${c(r)}</span>`}function Ue(t,e){return!t||t.length===0?"":`
        <div class="sm-section">
            <div class="sm-section-header">
                <span id="${e}-recent-label">Recent searches</span>
                <button class="sm-clear-recent" part="clear-recent">Clear</button>
            </div>
            ${t.map((n,r)=>`
                <div class="sm-result-item sm-recent-item" id="${y(e,r)}" role="option" aria-selected="false" data-index="${r}" data-url="${n.url||""}" data-query="${c(n.query)}">
                    <svg class="sm-result-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 16 14"/>
                    </svg>
                    <span class="sm-result-title">${c(n.title||n.query)}</span>
                    <svg class="sm-result-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </div>
            `).join("")}
        </div>
    `}function de(t){return!t||!t.trim()?`
            <div class="sm-empty" part="empty">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
                <p>Start typing to search</p>
            </div>
        `:`
        <div class="sm-empty" part="empty">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                <circle cx="12" cy="12" r="10"/>
                <path d="m15 9-6 6M9 9l6 6"/>
            </svg>
            <p>No results for "<strong>${c(t)}</strong>"</p>
        </div>
    `}function je(){return`
        <div class="sm-loading-state" part="loading-state">
            <svg class="sm-spinner" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" opacity="0.25"/>
                <path d="M12 2a10 10 0 0 1 10 10" stroke="currentColor" stroke-width="3" fill="none" stroke-linecap="round"/>
            </svg>
            <p>Searching...</p>
        </div>
    `}function ce(t,e){let{query:n,results:r,recentSearches:o,loading:a,showRecent:s}=t,{showLoadingIndicator:l=!0}=e,i=n&&n.trim();return a&&l?{html:je(),hasResults:!1,showListbox:!1}:i?!r||r.length===0?{html:de(n),hasResults:!1,showListbox:!1}:{html:He(r,n,e),hasResults:!0,showListbox:!0}:s&&o&&o.length>0?{html:Ue(o,e.listboxId),hasResults:!0,showListbox:!0}:{html:de(""),hasResults:!1,showListbox:!1}}function M(t,e,n=!1){if(!t)return"";let r=[];if(r.push(m("results",e,"generic")),t.took!==void 0){let i=t.took<1?"<1ms":`${Math.round(t.took)}ms`;r.push(m("time",i,"time"))}if(t.cacheEnabled!==void 0&&(t.cacheEnabled?t.cached?r.push(m("cache","hit","cache-hit")):r.push(m("cache","miss","cache-miss")):r.push(m("cache","off","cache-off"))),t.cacheDriver&&r.push(m("storage",t.cacheDriver,"cache-driver",t.cacheDriver)),t.indices&&t.indices.length>0){let i=t.indices.length>2?`${t.indices.length} indices`:t.indices.join(", ");r.push(m("indices",i,"generic"))}if(t.synonymsExpanded){let i=t.expandedQueries?t.expandedQueries.length-1:0;r.push(m("synonyms",`+${i}`,"synonyms"))}let o=t.rulesMatched?.length||0;r.push(m("rules",o,o>0?"rules":"generic"));let a=t.promotionsMatched?.length||0;r.push(m("promoted",a,a>0?"promotions":"generic"));let l=`<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">${n?'<path d="M6 9l6 6 6-6"/>':'<path d="M18 15l-6-6-6 6"/>'}</svg>`;return n?`<div class="sm-toolbar-collapsed-bar"><span class="sm-toolbar-collapsed-label">Debug</span>${l}</div>`:`<div class="sm-toolbar-content">${r.join("")}</div><button class="sm-toolbar-toggle" aria-label="Collapse debug panel" aria-expanded="true">${l}</button>`}function m(t,e,n,r=""){let o=r?` data-backend="${c(r)}"`:"";return`<span class="sm-toolbar-item"><span class="sm-toolbar-label">${c(t)}</span><span class="sm-toolbar-value" data-type="${c(n)}"${o}>${c(String(e))}</span></span>`}function ge(t,e){let{onSelect:n,onIndexChange:r,onEscape:o}=t,{listboxId:a}=e;return{handleKeydown(s,l,i){let d=i;switch(s.key){case"ArrowDown":return s.preventDefault(),d=Math.min(i+1,l-1),d!==i&&r&&r(d),d;case"ArrowUp":return s.preventDefault(),d=Math.max(i-1,-1),d!==i&&r&&r(d),d;case"Enter":return s.preventDefault(),i>=0&&n&&n(i),null;case"Escape":return s.preventDefault(),o&&o(),null;default:return null}},getListboxId(){return a}}}function ue(t,e,n={}){let{scrollContainer:r,inputElement:o,listboxId:a,selectedClass:s="sm-selected"}=n,l=e>=0?y(a,e):null;o&&R(o,{expanded:t.length>0,activeDescendant:l,listboxId:a}),t.forEach((i,d)=>{let g=d===e;i.classList.toggle(s,g),i.setAttribute("aria-selected",String(g)),g&&r&&ie(i,r)})}function he(t,e){t.forEach((n,r)=>{n.addEventListener("mouseenter",()=>{e&&e(r)})})}var O=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.config=null,this.state=_({...S},this.handleStateChange.bind(this)),this.abortController=null,this.debounceTimer=null,this.analyticsIdleTimer=null,this.lastTrackedQuery=null,this.listboxId=L("sm-listbox"),this.inputId=L("sm-input"),this.liveRegion=null,this.keyboardNavigator=null,this.elements={},this.handleInput=this.handleInput.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.handleResultClick=this.handleResultClick.bind(this)}get widgetType(){throw new Error("Subclass must implement widgetType getter")}render(){throw new Error("Subclass must implement render()")}getResultsContainer(){throw new Error("Subclass must implement getResultsContainer()")}getInputElement(){throw new Error("Subclass must implement getInputElement()")}getLoadingElement(){return this.elements.loading||null}getDebugToolbarElement(){return this.elements.debugToolbar||null}connectedCallback(){this.config=D(this,this.widgetType),this.state.set({recentSearches:A(this.config.index)}),this.keyboardNavigator=ge({onSelect:e=>this.selectResultAtIndex(e),onIndexChange:e=>this.state.set({selectedIndex:e}),onEscape:()=>this.handleEscape()},{listboxId:this.listboxId})}disconnectedCallback(){this.abortController&&(this.abortController.abort(),this.abortController=null),this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null)}attributeChangedCallback(e,n,r){n!==r&&this.shadowRoot.children.length>0&&(this.config=D(this,this.widgetType),this.render(),this.applyCustomStyles())}handleStateChange(e,n){(n.includes("results")||n.includes("query")||n.includes("recentSearches"))&&this.renderResultsContent(),(n.includes("results")||n.includes("meta"))&&this.updateDebugToolbar(),n.includes("selectedIndex")&&this.updateSelectionVisual(),n.includes("loading")&&this.updateLoadingVisual()}handleInput(e){let n=e.target.value;if(this.state.set({query:n,selectedIndex:-1}),this.debounceTimer&&clearTimeout(this.debounceTimer),this.analyticsIdleTimer&&(clearTimeout(this.analyticsIdleTimer),this.analyticsIdleTimer=null),!n.trim()){this.state.set({results:[]});return}n.length<this.config.minChars||(this.debounceTimer=setTimeout(()=>{this.executeSearch(n)},this.config.debounce))}async executeSearch(e){this.abortController&&this.abortController.abort(),this.abortController=new AbortController,this.state.set({loading:!0,error:null}),this.liveRegion&&v(this.liveRegion,ae());try{let{results:n,meta:r}=await G({query:e,endpoint:this.config.searchEndpoint,indices:this.config.indices,siteId:this.config.siteId,maxResults:this.config.maxResults,hideResultsWithoutUrl:this.config.hideResultsWithoutUrl,debug:this.config.debug,signal:this.abortController.signal});this.state.set({results:n,meta:r,loading:!1,selectedIndex:n.length>0?0:-1}),this.liveRegion&&v(this.liveRegion,$(n.length,e)),this.dispatchWidgetEvent("search",{query:e,results:n,meta:r}),this.startAnalyticsIdleTimer(e,n.length)}catch(n){if(n.name==="AbortError")return;console.error("Search error:",n),this.state.set({results:[],loading:!1,error:n.message}),this.dispatchWidgetEvent("error",{query:e,error:n.message})}}renderResultsContent(){let e=this.getResultsContainer();if(!e)return;let n=this.state.getAll(),{showRecent:r,groupResults:o,enableHighlighting:a,highlightTag:s,highlightClass:l,showLoadingIndicator:i,debug:d}=this.config,{html:g,hasResults:u,showListbox:f}=ce({query:n.query,results:n.results,recentSearches:n.recentSearches,loading:n.loading,showRecent:r},{listboxId:this.listboxId,groupResults:o,enableHighlighting:a,highlightTag:s,highlightClass:l,showLoadingIndicator:i,debug:d,promotions:this.config.promotions});e.innerHTML=g,f?e.setAttribute("role","listbox"):e.removeAttribute("role");let k=this.getInputElement();k&&R(k,{expanded:u,activeDescendant:null,listboxId:this.listboxId}),this.liveRegion&&!n.loading&&(n.query&&n.results.length===0?v(this.liveRegion,$(0,n.query)):!n.query&&n.recentSearches.length>0&&r&&v(this.liveRegion,se(n.recentSearches.length))),this.attachResultHandlers();let x=e.querySelector(".sm-clear-recent");x&&x.addEventListener("click",w=>{w.stopPropagation(),X(this.config.index),this.state.set({recentSearches:[]})}),u&&n.results.length>0&&this.state.set({selectedIndex:0})}attachResultHandlers(){let e=this.getResultsContainer();if(!e)return;let n=e.querySelectorAll(".sm-result-item");n.forEach(r=>{r.addEventListener("click",o=>this.handleResultClick(o,r))}),he(n,r=>{this.state.set({selectedIndex:r})})}updateSelectionVisual(){let e=this.getResultsContainer(),n=this.getInputElement();if(!e)return;let r=e.querySelectorAll(".sm-result-item"),o=this.state.get("selectedIndex");ue(r,o,{scrollContainer:e,inputElement:n,listboxId:this.listboxId})}handleKeydown(e){let n=this.getResultsContainer();if(!n)return;let r=n.querySelectorAll(".sm-result-item"),o=this.state.get("selectedIndex");if(e.key==="Enter"){let a=this.state.get("query"),s=this.state.get("results")||[];a&&s.length>0&&this.trackSearchAnalytics(a,s.length,"enter")}this.keyboardNavigator.handleKeydown(e,r.length,o)}selectResultAtIndex(e){let n=this.getResultsContainer();if(!n)return;let r=n.querySelectorAll(".sm-result-item");e>=0&&r[e]&&r[e].click()}handleEscape(){}handleResultClick(e,n){let r=n.getAttribute("href"),o=n.dataset.url,a=r||o,s=n.dataset.title||n.querySelector(".sm-result-title")?.textContent,l=n.dataset.id,i=n.dataset.query||this.state.get("query"),d=n.classList.contains("sm-recent-item");if(!d&&i){let g=Q(this.config.index,i,{title:s,url:a},this.config.maxRecentSearches);this.state.set({recentSearches:g})}if(l&&this.config.index&&K({endpoint:this.config.trackClickEndpoint,elementId:l,query:i,index:this.config.index}),!d&&i&&this.trackSearchAnalytics(i,this.state.get("results")?.length||0,"click"),this.dispatchWidgetEvent("result-click",{id:l,title:s,url:a,query:i,isRecent:d}),a&&a!=="#")d&&(e.preventDefault(),window.location.href=a),this.onResultSelected(a,s,l);else if(i){e.preventDefault();let g=this.getInputElement();g&&(g.value=i,this.state.set({query:i}),this.executeSearch(i))}}onResultSelected(e,n,r){}updateLoadingVisual(){let e=this.getLoadingElement();if(e){let n=this.state.get("loading"),r=this.config?.showLoadingIndicator!==!1;e.hidden=!n||!r}}updateDebugToolbar(){let e=this.getDebugToolbarElement();if(!e)return;let{debug:n}=this.config,r=this.state.getAll();if(!n||!r.meta||r.results.length===0){e.hidden=!0;return}let o=e.classList.contains("sm-collapsed");e.innerHTML=M(r.meta,r.results.length,o),e.hidden=!1,o&&e.classList.add("sm-collapsed"),this.attachDebugToolbarHandlers(e)}attachDebugToolbarHandlers(e){let n=e.querySelector(".sm-toolbar-toggle");n&&n.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),this.toggleDebugToolbar()});let r=e.querySelector(".sm-toolbar-collapsed-bar");r&&r.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),this.toggleDebugToolbar()})}toggleDebugToolbar(){let e=this.getDebugToolbarElement();if(!e)return;let n=e.classList.toggle("sm-collapsed"),r=this.state.getAll();e.innerHTML=M(r.meta,r.results.length,n),n&&e.classList.add("sm-collapsed"),this.attachDebugToolbarHandlers(e)}applyCustomStyles(){if(!this.config)return;let e=this.shadowRoot.host,{theme:n,styles:r}=this.config;re(e,r,n)}initializeLiveRegion(){this.liveRegion=oe(this.shadowRoot)}startAnalyticsIdleTimer(e,n){this.analyticsIdleTimer&&clearTimeout(this.analyticsIdleTimer);let r=this.config.idleTimeout;!r||r<=0||(this.analyticsIdleTimer=setTimeout(()=>{this.trackSearchAnalytics(e,n,"idle")},r))}trackSearchAnalytics(e,n,r){!e||e===this.lastTrackedQuery||(this.lastTrackedQuery=e,this.analyticsIdleTimer&&(clearTimeout(this.analyticsIdleTimer),this.analyticsIdleTimer=null),V({endpoint:this.config.trackSearchEndpoint,query:e,indices:this.config.indices,resultsCount:n,trigger:r,source:this.config.source,siteId:this.config.siteId}))}resetAnalyticsTracking(){this.lastTrackedQuery=null,this.analyticsIdleTimer&&(clearTimeout(this.analyticsIdleTimer),this.analyticsIdleTimer=null)}dispatchWidgetEvent(e,n={}){this.dispatchEvent(new CustomEvent(`search-${e}`,{bubbles:!0,composed:!0,detail:n}))}},me=O;var pe=`/**
 * Search Widget Base Styles
 *
 * Shared styles used by all widget types (modal, page, inline).
 * These styles handle results display, highlighting, loading states,
 * and accessibility utilities.
 *
 * @module styles/base
 * @author Search Manager
 * @since 5.x
 */

/* =========================================================================
   HOST & RESET
   ========================================================================= */

:host {
    /* Text colors - semantic naming with config variable mapping */
    /* Color contrast ratios meet WCAG 2.1 AA (4.5:1 for normal text) */
    --sm-text-primary: var(--sm-result-text-color, #111827);
    --sm-text-secondary: var(--sm-result-desc-color, #4b5563);
    --sm-text-muted: var(--sm-result-muted-color, #6b7280);

    /* Input defaults */
    --sm-input-bg: #ffffff;
    --sm-input-color: #111827;
    --sm-input-placeholder: #9ca3af;
    --sm-input-font-size: 16px;

    /* Borders and backgrounds - map from config variable names */
    --sm-border-color: var(--sm-input-border-color, #e5e7eb);
    --sm-hover-bg: var(--sm-result-hover-bg, #f3f4f6);
    --sm-selected-bg: var(--sm-result-active-bg, #e5e7eb);
    --sm-selected-border: #3b82f6;
    --sm-result-radius: 8px;

    /* Highlighting */
    --sm-highlight-bg: #fef08a;
    --sm-highlight-color: #854d0e;

    /* Kbd / keyboard shortcuts - 4.5:1 contrast ratio minimum */
    --sm-kbd-bg: #f3f4f6;
    --sm-kbd-border: #d1d5db;
    --sm-kbd-color: var(--sm-kbd-text-color, #4b5563);
    --sm-kbd-radius: 4px;

    /* Accent colors */
    --sm-accent: #3b82f6;
    --sm-accent-hover: #2563eb;

    /* Spinner */
    --sm-spinner-color: var(--sm-spinner-color-light, #3b82f6);

    display: inline-block;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
}

/* Dark theme base variables */
/* Color contrast ratios meet WCAG 2.1 AA (4.5:1 for normal text, 3:1 for large text) */
:host([data-theme="dark"]) {
    --sm-input-bg: var(--sm-input-bg-dark, #1f2937);
    --sm-input-color: var(--sm-input-color-dark, #f9fafb);
    --sm-input-placeholder: var(--sm-input-placeholder-dark, #9ca3af);

    --sm-text-primary: var(--sm-result-text-color-dark, #f9fafb);
    --sm-text-secondary: var(--sm-result-desc-color-dark, #d1d5db);
    --sm-text-muted: var(--sm-result-muted-color-dark, #9ca3af);

    --sm-border-color: var(--sm-input-border-color-dark, #374151);
    --sm-hover-bg: var(--sm-result-hover-bg-dark, #374151);
    --sm-selected-bg: var(--sm-result-active-bg-dark, #4b5563);
    --sm-selected-border: #3b82f6;

    --sm-highlight-bg: var(--sm-highlight-bg-dark, #854d0e);
    --sm-highlight-color: var(--sm-highlight-color-dark, #fef08a);

    --sm-kbd-bg: var(--sm-kbd-bg-dark, #374151);
    --sm-kbd-border: #4b5563;
    --sm-kbd-color: var(--sm-kbd-text-color-dark, #e5e7eb);

    --sm-spinner-color: var(--sm-spinner-color-dark, #60a5fa);
}

*, *::before, *::after {
    box-sizing: border-box;
}

/* =========================================================================
   INPUT
   ========================================================================= */

.sm-input {
    flex: 1;
    border: none;
    background: var(--sm-input-bg);
    color: var(--sm-input-color);
    font-size: var(--sm-input-font-size);
    outline: none;
}

.sm-input::placeholder {
    color: var(--sm-input-placeholder);
}

/* =========================================================================
   LOADING STATE
   ========================================================================= */

.sm-loading {
    flex-shrink: 0;
}

.sm-spinner {
    animation: sm-spin 1s linear infinite;
    color: var(--sm-spinner-color);
}

@keyframes sm-spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.sm-loading-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 48px 24px;
    color: var(--sm-text-muted);
    text-align: center;
}

.sm-loading-state p {
    margin: 0;
    font-size: 14px;
}

/* =========================================================================
   RESULTS CONTAINER
   ========================================================================= */

.sm-results {
    flex: 1;
    overflow-y: auto;
    padding: 8px;
}

/* =========================================================================
   SECTION GROUPING
   ========================================================================= */

.sm-section {
    margin-bottom: 8px;
}

.sm-section:last-child {
    margin-bottom: 0;
}

.sm-section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    font-size: 12px;
    font-weight: 600;
    color: var(--sm-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.sm-clear-recent {
    padding: 2px 8px;
    background: transparent;
    border: none;
    border-radius: var(--sm-kbd-radius);
    font-size: 11px;
    color: var(--sm-text-muted);
    cursor: pointer;
    text-transform: none;
    letter-spacing: normal;
}

.sm-clear-recent:hover {
    background: var(--sm-hover-bg);
    color: var(--sm-text-secondary);
}

/* =========================================================================
   RESULT ITEM
   ========================================================================= */

.sm-result-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    border-radius: var(--sm-result-radius);
    color: var(--sm-text-primary);
    text-decoration: none;
    cursor: pointer;
    transition: background 0.1s ease;
}

.sm-result-item:hover,
.sm-result-item.sm-selected {
    background: var(--sm-hover-bg);
}

.sm-result-item.sm-selected {
    background: var(--sm-selected-bg);
    outline: 2px solid var(--sm-selected-border);
    outline-offset: -2px;
}

.sm-result-icon {
    flex-shrink: 0;
    color: var(--sm-text-muted);
}

.sm-result-content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.sm-result-title {
    font-size: 14px;
    font-weight: 500;
    color: var(--sm-text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.sm-result-desc {
    font-size: 13px;
    color: var(--sm-text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.sm-result-type {
    flex-shrink: 0;
    padding: 2px 8px;
    background: var(--sm-kbd-bg);
    border-radius: var(--sm-kbd-radius);
    font-size: 11px;
    color: var(--sm-text-muted);
}

.sm-result-arrow {
    flex-shrink: 0;
    color: var(--sm-text-muted);
    opacity: 0;
    transition: opacity 0.1s ease;
}

.sm-result-item:hover .sm-result-arrow,
.sm-result-item.sm-selected .sm-result-arrow {
    opacity: 1;
}

/* =========================================================================
   PROMOTED RESULTS
   ========================================================================= */

.sm-result-item.sm-promoted {
    position: relative;
}

.sm-promoted-badge {
    position: absolute;
    padding: 2px 6px;
    background: var(--sm-accent);
    color: #ffffff;
    font-size: 10px;
    font-weight: 600;
    border-radius: var(--sm-kbd-radius);
    text-transform: uppercase;
    letter-spacing: 0.02em;
}

.sm-promoted-badge--top-right {
    top: 4px;
    right: 4px;
}

.sm-promoted-badge--top-left {
    top: 4px;
    left: 4px;
}

.sm-promoted-badge--inline {
    position: static;
    margin-left: 8px;
}

/* =========================================================================
   HIGHLIGHTING
   ========================================================================= */

/* Uses .sm-highlight class to work with any tag (mark, span, etc.) */
.sm-highlight {
    background: var(--sm-highlight-bg);
    color: var(--sm-highlight-color);
    border-radius: 2px;
    padding: 0 2px;
}

/* =========================================================================
   EMPTY STATE
   ========================================================================= */

.sm-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 48px 24px;
    color: var(--sm-text-muted);
    text-align: center;
}

.sm-empty p {
    margin: 0;
    font-size: 14px;
}

.sm-empty strong {
    color: var(--sm-text-secondary);
}

/* =========================================================================
   ACCESSIBILITY
   ========================================================================= */

/* Screen reader only - visually hidden but accessible */
.sm-sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* =========================================================================
   RTL SUPPORT (BASE)
   ========================================================================= */

:host([dir="rtl"]) .sm-result-item {
    direction: rtl;
}

:host([dir="rtl"]) .sm-result-arrow {
    transform: scaleX(-1);
}
`;var be=`/**
 * Search Widget Modal Styles
 *
 * Styles specific to the modal widget variant.
 * Includes backdrop, modal container, trigger button,
 * header, footer, and mobile responsive behavior.
 *
 * @module styles/modal
 * @author Search Manager
 * @since 5.x
 */

/* =========================================================================
   MODAL-SPECIFIC HOST VARIABLES
   ========================================================================= */

:host {
    /* Modal container */
    --sm-modal-bg: #ffffff;
    --sm-modal-border: var(--sm-modal-border-color, #e5e7eb);
    --sm-modal-border-width: 1px;
    --sm-modal-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    --sm-modal-radius: 12px;
    --sm-modal-width: 640px;
    --sm-modal-max-height: 80vh;

    /* Trigger button */
    --sm-trigger-bg: #ffffff;
    --sm-trigger-color: var(--sm-trigger-text-color, #374151);
    --sm-trigger-border: var(--sm-trigger-border-color, #d1d5db);
    --sm-trigger-radius: 8px;
    --sm-trigger-border-width: 1px;
    --sm-trigger-px: 12px;
    --sm-trigger-py: 8px;
    --sm-trigger-font-size: 14px;
}

/* Dark theme - modal-specific overrides */
:host([data-theme="dark"]) {
    --sm-modal-bg: var(--sm-modal-bg-dark, #1f2937);
    --sm-modal-border: var(--sm-modal-border-color-dark, #374151);

    --sm-trigger-bg: var(--sm-trigger-bg-dark, #374151);
    --sm-trigger-color: var(--sm-trigger-text-color-dark, #e5e7eb);
    --sm-trigger-border: var(--sm-trigger-border-color-dark, #4b5563);
}

/* =========================================================================
   TRIGGER BUTTON
   ========================================================================= */

.sm-trigger {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: var(--sm-trigger-py) var(--sm-trigger-px);
    background: var(--sm-trigger-bg);
    border: var(--sm-trigger-border-width) solid var(--sm-trigger-border);
    border-radius: var(--sm-trigger-radius);
    color: var(--sm-trigger-color);
    font-size: var(--sm-trigger-font-size);
    cursor: pointer;
    transition: all 0.15s ease;
}

.sm-trigger:hover {
    border-color: var(--sm-accent);
    color: var(--sm-text-primary);
}

.sm-trigger-text {
    /* Text shown next to search icon */
}

.sm-trigger-kbd {
    display: inline-flex;
    align-items: center;
    padding: 2px 6px;
    background: var(--sm-kbd-bg);
    border: 1px solid var(--sm-kbd-border);
    border-radius: var(--sm-kbd-radius);
    font-size: 11px;
    font-family: inherit;
    color: var(--sm-kbd-color);
}

/* =========================================================================
   BACKDROP
   ========================================================================= */

.sm-backdrop {
    position: fixed;
    inset: 0;
    z-index: 99999;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    padding-top: 10vh;
    background: rgba(0, 0, 0, var(--sm-backdrop-opacity, 0.5));
    backdrop-filter: var(--sm-backdrop-blur, blur(4px));
    animation: sm-fade-in 0.15s ease;
}

.sm-backdrop[hidden] {
    display: none;
}

@keyframes sm-fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* =========================================================================
   MODAL CONTAINER
   ========================================================================= */

.sm-modal {
    width: var(--sm-modal-width);
    max-width: calc(100vw - 32px);
    max-height: var(--sm-modal-max-height);
    background: var(--sm-modal-bg);
    border: var(--sm-modal-border-width, 1px) solid var(--sm-modal-border);
    border-radius: var(--sm-modal-radius);
    box-shadow: var(--sm-modal-shadow);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    animation: sm-slide-up 0.2s ease;
}

@keyframes sm-slide-up {
    from {
        opacity: 0;
        transform: translateY(-10px) scale(0.98);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* =========================================================================
   MODAL HEADER
   ========================================================================= */

.sm-header {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    border-bottom: 1px solid var(--sm-border-color);
}

.sm-search-icon {
    flex-shrink: 0;
    color: var(--sm-text-muted);
}

.sm-close {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    padding: 4px 8px;
    background: transparent;
    border: none;
    cursor: pointer;
}

.sm-close kbd {
    padding: 2px 6px;
    background: var(--sm-kbd-bg);
    border: 1px solid var(--sm-kbd-border);
    border-radius: var(--sm-kbd-radius);
    font-size: 11px;
    font-family: inherit;
    color: var(--sm-kbd-color);
}

/* =========================================================================
   MODAL FOOTER
   ========================================================================= */

.sm-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    padding: 12px 16px;
    border-top: 1px solid var(--sm-border-color);
    font-size: 12px;
    color: var(--sm-text-muted);
}

.sm-footer-hints {
    display: flex;
    align-items: center;
    gap: 12px;
}

.sm-footer-hints span {
    display: flex;
    align-items: center;
    gap: 4px;
}

.sm-footer kbd {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 20px;
    padding: 2px 4px;
    background: var(--sm-kbd-bg);
    border: 1px solid var(--sm-kbd-border);
    border-radius: var(--sm-kbd-radius);
    font-size: 10px;
    font-family: inherit;
    color: var(--sm-kbd-color);
}

.sm-footer-brand {
    color: var(--sm-text-muted);
}

.sm-footer-brand strong {
    color: var(--sm-text-secondary);
}

/* =========================================================================
   RTL SUPPORT (MODAL-SPECIFIC)
   ========================================================================= */

:host([dir="rtl"]) .sm-header,
:host([dir="rtl"]) .sm-footer {
    direction: rtl;
}

/* =========================================================================
   MOBILE RESPONSIVE
   ========================================================================= */

@media (max-width: 640px) {
    .sm-backdrop {
        padding-top: 0;
        align-items: flex-end;
    }

    .sm-modal {
        max-width: 100%;
        max-height: 90vh;
        border-radius: var(--sm-modal-radius) var(--sm-modal-radius) 0 0;
    }

    .sm-trigger-text,
    .sm-footer-hints {
        display: none;
    }
}
`;var fe=`/* =========================================================================
   DEBUG MODE - Developer Tools Panel
   Extensible key:value format with labels for clarity
   ========================================================================= */

/* Result item with debug enabled - column layout for full-width debug bar */
.sm-result-item.sm-debug-enabled {
    flex-direction: column;
    padding: 0;
    gap: 0;
}

/* Main content wrapper (icon, content, arrow) - flex row like normal result */
.sm-result-main {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    width: 100%;
}

/* Debug info bar - full width at bottom of result */
.sm-debug-info {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 3px 10px;
    width: 100%;
    padding: 6px 12px;
    background: #f1f5f9;
    border-top: 1px solid #e2e8f0;
    border-radius: 0 0 var(--sm-result-radius) var(--sm-result-radius);
    font-size: 10px;
    font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Monaco, Consolas, monospace;
    line-height: 1.5;
    /* Debug info is always LTR - technical English labels/values */
    direction: ltr;
    text-align: left;
}

:host([data-theme="dark"]) .sm-debug-info {
    background: rgba(15, 23, 42, 0.6);
    border-top-color: #334155;
}

/* Each debug item: label + value pair */
.sm-debug-item {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    white-space: nowrap;
}

/* Labels - dimmed, uppercase */
.sm-debug-label {
    color: #64748b;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 9px;
    letter-spacing: 0.03em;
}

:host([data-theme="dark"]) .sm-debug-label {
    color: #94a3b8;
}

/* Values - base style */
.sm-debug-value {
    padding: 1px 5px;
    border-radius: 3px;
    font-weight: 500;
}

/* Backend values - color coded */
.sm-debug-value[data-backend="mysql"] {
    background: rgba(245, 158, 11, 0.15);
    color: #92400e;
}
.sm-debug-value[data-backend="redis"] {
    background: rgba(220, 38, 38, 0.12);
    color: #991b1b;
}
.sm-debug-value[data-backend="typesense"] {
    background: rgba(139, 92, 246, 0.12);
    color: #6d28d9;
}
.sm-debug-value[data-backend="algolia"] {
    background: rgba(6, 182, 212, 0.12);
    color: #0e7490;
}
.sm-debug-value[data-backend="meilisearch"] {
    background: rgba(236, 72, 153, 0.12);
    color: #9d174d;
}
.sm-debug-value[data-backend="file"] {
    background: rgba(107, 114, 128, 0.12);
    color: #4b5563;
}
.sm-debug-value[data-backend="pgsql"] {
    background: rgba(59, 130, 246, 0.12);
    color: #1d4ed8;
}
.sm-debug-value[data-backend="elasticsearch"] {
    background: rgba(254, 197, 20, 0.15);
    color: #a16207;
}

/* Index value - outlined style */
.sm-debug-value[data-type="index"] {
    background: transparent;
    border: 1px solid #cbd5e1;
    color: #475569;
}

:host([data-theme="dark"]) .sm-debug-value[data-type="index"] {
    border-color: #475569;
    color: #94a3b8;
}

/* Generic values - subtle */
.sm-debug-value[data-type="generic"] {
    background: rgba(100, 116, 139, 0.1);
    color: #475569;
}

:host([data-theme="dark"]) .sm-debug-value[data-type="generic"] {
    background: rgba(148, 163, 184, 0.15);
    color: #cbd5e1;
}

/* Score value - highlighted */
.sm-debug-value[data-type="score"] {
    background: rgba(34, 197, 94, 0.1);
    color: #166534;
}

:host([data-theme="dark"]) .sm-debug-value[data-type="score"] {
    background: rgba(34, 197, 94, 0.15);
    color: #86efac;
}

/* Matched fields value - purple/blue to highlight important debug info */
.sm-debug-value[data-type="matched"] {
    background: rgba(99, 102, 241, 0.1);
    color: #4338ca;
}

:host([data-theme="dark"]) .sm-debug-value[data-type="matched"] {
    background: rgba(99, 102, 241, 0.15);
    color: #a5b4fc;
}

/* Promoted value - gold/yellow to indicate featured/promoted */
.sm-debug-value[data-type="promoted"] {
    background: rgba(245, 158, 11, 0.15);
    color: #b45309;
}

:host([data-theme="dark"]) .sm-debug-value[data-type="promoted"] {
    background: rgba(245, 158, 11, 0.2);
    color: #fcd34d;
}

/* Boosted value - green to indicate positive boost */
.sm-debug-value[data-type="boosted"] {
    background: rgba(34, 197, 94, 0.1);
    color: #166534;
}

:host([data-theme="dark"]) .sm-debug-value[data-type="boosted"] {
    background: rgba(34, 197, 94, 0.15);
    color: #86efac;
}

/* Dark mode backend colors */
:host([data-theme="dark"]) .sm-debug-value[data-backend="mysql"] {
    background: rgba(245, 158, 11, 0.2);
    color: #fcd34d;
}
:host([data-theme="dark"]) .sm-debug-value[data-backend="redis"] {
    background: rgba(220, 38, 38, 0.2);
    color: #fca5a5;
}
:host([data-theme="dark"]) .sm-debug-value[data-backend="typesense"] {
    background: rgba(139, 92, 246, 0.2);
    color: #c4b5fd;
}
:host([data-theme="dark"]) .sm-debug-value[data-backend="algolia"] {
    background: rgba(6, 182, 212, 0.2);
    color: #67e8f9;
}
:host([data-theme="dark"]) .sm-debug-value[data-backend="meilisearch"] {
    background: rgba(236, 72, 153, 0.2);
    color: #f9a8d4;
}
:host([data-theme="dark"]) .sm-debug-value[data-backend="file"] {
    background: rgba(156, 163, 175, 0.2);
    color: #d1d5db;
}
:host([data-theme="dark"]) .sm-debug-value[data-backend="pgsql"] {
    background: rgba(59, 130, 246, 0.2);
    color: #93c5fd;
}
:host([data-theme="dark"]) .sm-debug-value[data-backend="elasticsearch"] {
    background: rgba(254, 197, 20, 0.2);
    color: #fde047;
}

/* =========================================================================
   DEBUG TOOLBAR - Floating search summary panel
   ========================================================================= */

.sm-debug-toolbar {
    display: flex;
    flex-wrap: nowrap;
    align-items: stretch;
    justify-content: center;
    gap: 0;
    padding: 0;
    background: linear-gradient(to bottom, #f8fafc, #f1f5f9);
    border-top: 1px solid #e2e8f0;
    box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.04);
    font-size: 11px;
    font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Monaco, Consolas, monospace;
    direction: ltr;
    text-align: center;
    flex-shrink: 0;
    overflow: hidden;
}

:host([data-theme="dark"]) .sm-debug-toolbar {
    background: linear-gradient(to bottom, #1e293b, #0f172a);
    border-top-color: #334155;
    box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.2);
}

/* Toggle button (right side when expanded) */
.sm-toolbar-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    padding: 0;
    background: transparent;
    border: none;
    border-left: 1px solid #e2e8f0;
    color: #94a3b8;
    cursor: pointer;
    transition: background 0.15s, color 0.15s;
    flex-shrink: 0;
}

.sm-toolbar-toggle:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #475569;
}

:host([data-theme="dark"]) .sm-toolbar-toggle {
    border-left-color: #334155;
    color: #64748b;
}

:host([data-theme="dark"]) .sm-toolbar-toggle:hover {
    background: rgba(255, 255, 255, 0.05);
    color: #94a3b8;
}

/* Content wrapper */
.sm-toolbar-content {
    display: flex;
    flex-wrap: nowrap;
    align-items: stretch;
    flex: 1;
    overflow-x: auto;
}

/* Collapsed bar - entire bar is clickable */
.sm-toolbar-collapsed-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: 8px 12px;
    cursor: pointer;
    transition: background 0.15s;
}

.sm-toolbar-collapsed-bar:hover {
    background: rgba(0, 0, 0, 0.03);
}

:host([data-theme="dark"]) .sm-toolbar-collapsed-bar:hover {
    background: rgba(255, 255, 255, 0.03);
}

.sm-toolbar-collapsed-label {
    color: #64748b;
    font-weight: 600;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

:host([data-theme="dark"]) .sm-toolbar-collapsed-label {
    color: #94a3b8;
}

.sm-toolbar-collapsed-bar svg {
    color: #94a3b8;
}

:host([data-theme="dark"]) .sm-toolbar-collapsed-bar svg {
    color: #64748b;
}

/* Toolbar item - stacked vertically (value on top, label below) */
.sm-toolbar-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
    padding: 8px 14px;
    border-right: 1px solid #e2e8f0;
}

.sm-toolbar-item:last-child {
    border-right: none;
}

:host([data-theme="dark"]) .sm-toolbar-item {
    border-right-color: #334155;
}

/* Label below value - small uppercase */
.sm-toolbar-label {
    order: 2; /* Put below value */
    color: #475569;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 8px;
    letter-spacing: 0.05em;
}

:host([data-theme="dark"]) .sm-toolbar-label {
    color: #94a3b8;
}

.sm-toolbar-value {
    padding: 2px 6px;
    border-radius: 3px;
    font-weight: 600;
}

/* Generic values */
.sm-toolbar-value[data-type="generic"] {
    background: rgba(100, 116, 139, 0.12);
    color: #334155;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-type="generic"] {
    background: rgba(148, 163, 184, 0.15);
    color: #e2e8f0;
}

/* Time - blue tint */
.sm-toolbar-value[data-type="time"] {
    background: rgba(59, 130, 246, 0.12);
    color: #1d4ed8;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-type="time"] {
    background: rgba(59, 130, 246, 0.2);
    color: #93c5fd;
}

/* Cache hit - green */
.sm-toolbar-value[data-type="cache-hit"] {
    background: rgba(34, 197, 94, 0.15);
    color: #166534;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-type="cache-hit"] {
    background: rgba(34, 197, 94, 0.2);
    color: #86efac;
}

/* Cache miss - amber */
.sm-toolbar-value[data-type="cache-miss"] {
    background: rgba(245, 158, 11, 0.15);
    color: #92400e;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-type="cache-miss"] {
    background: rgba(245, 158, 11, 0.2);
    color: #fcd34d;
}

/* Cache off - gray */
.sm-toolbar-value[data-type="cache-off"] {
    background: rgba(107, 114, 128, 0.12);
    color: #6b7280;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-type="cache-off"] {
    background: rgba(107, 114, 128, 0.2);
    color: #9ca3af;
}

/* Cache driver types */
.sm-toolbar-value[data-type="cache-driver"][data-backend="redis"] {
    background: rgba(220, 38, 38, 0.12);
    color: #b91c1c;
}
.sm-toolbar-value[data-type="cache-driver"][data-backend="file"] {
    background: rgba(107, 114, 128, 0.12);
    color: #4b5563;
}
.sm-toolbar-value[data-type="cache-driver"][data-backend="memcached"] {
    background: rgba(34, 197, 94, 0.12);
    color: #166534;
}
.sm-toolbar-value[data-type="cache-driver"][data-backend="database"] {
    background: rgba(59, 130, 246, 0.12);
    color: #1d4ed8;
}
.sm-toolbar-value[data-type="cache-driver"][data-backend="apcu"] {
    background: rgba(168, 85, 247, 0.12);
    color: #7c3aed;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-type="cache-driver"][data-backend="redis"] {
    background: rgba(220, 38, 38, 0.2);
    color: #fca5a5;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-type="cache-driver"][data-backend="file"] {
    background: rgba(156, 163, 175, 0.2);
    color: #d1d5db;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-type="cache-driver"][data-backend="memcached"] {
    background: rgba(34, 197, 94, 0.2);
    color: #86efac;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-type="cache-driver"][data-backend="database"] {
    background: rgba(59, 130, 246, 0.2);
    color: #93c5fd;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-type="cache-driver"][data-backend="apcu"] {
    background: rgba(168, 85, 247, 0.2);
    color: #c4b5fd;
}

/* Synonyms - purple */
.sm-toolbar-value[data-type="synonyms"] {
    background: rgba(139, 92, 246, 0.12);
    color: #6d28d9;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-type="synonyms"] {
    background: rgba(139, 92, 246, 0.2);
    color: #c4b5fd;
}

/* Rules - cyan */
.sm-toolbar-value[data-type="rules"] {
    background: rgba(6, 182, 212, 0.12);
    color: #0e7490;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-type="rules"] {
    background: rgba(6, 182, 212, 0.2);
    color: #67e8f9;
}

/* Promotions - pink */
.sm-toolbar-value[data-type="promotions"] {
    background: rgba(236, 72, 153, 0.12);
    color: #9d174d;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-type="promotions"] {
    background: rgba(236, 72, 153, 0.2);
    color: #f9a8d4;
}

/* Backend values - reuse colors from debug info */
.sm-toolbar-value[data-backend="mysql"] {
    background: rgba(245, 158, 11, 0.15);
    color: #92400e;
}
.sm-toolbar-value[data-backend="redis"] {
    background: rgba(220, 38, 38, 0.12);
    color: #991b1b;
}
.sm-toolbar-value[data-backend="typesense"] {
    background: rgba(139, 92, 246, 0.12);
    color: #6d28d9;
}
.sm-toolbar-value[data-backend="algolia"] {
    background: rgba(6, 182, 212, 0.12);
    color: #0e7490;
}
.sm-toolbar-value[data-backend="meilisearch"] {
    background: rgba(236, 72, 153, 0.12);
    color: #9d174d;
}
.sm-toolbar-value[data-backend="file"] {
    background: rgba(107, 114, 128, 0.12);
    color: #4b5563;
}
.sm-toolbar-value[data-backend="pgsql"] {
    background: rgba(59, 130, 246, 0.12);
    color: #1d4ed8;
}

:host([data-theme="dark"]) .sm-toolbar-value[data-backend="mysql"] {
    background: rgba(245, 158, 11, 0.2);
    color: #fcd34d;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-backend="redis"] {
    background: rgba(220, 38, 38, 0.2);
    color: #fca5a5;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-backend="typesense"] {
    background: rgba(139, 92, 246, 0.2);
    color: #c4b5fd;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-backend="algolia"] {
    background: rgba(6, 182, 212, 0.2);
    color: #67e8f9;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-backend="meilisearch"] {
    background: rgba(236, 72, 153, 0.2);
    color: #f9a8d4;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-backend="file"] {
    background: rgba(156, 163, 175, 0.2);
    color: #d1d5db;
}
:host([data-theme="dark"]) .sm-toolbar-value[data-backend="pgsql"] {
    background: rgba(59, 130, 246, 0.2);
    color: #93c5fd;
}
`;var ze=pe+`
`+be+`
`+fe,P=class extends me{constructor(){super(),this.externalTrigger=null,this.open=this.open.bind(this),this.close=this.close.bind(this),this.toggle=this.toggle.bind(this),this.handleGlobalKeydown=this.handleGlobalKeydown.bind(this),this.handleBackdropClick=this.handleBackdropClick.bind(this)}get widgetType(){return"modal"}static get observedAttributes(){return W("modal")}connectedCallback(){super.connectedCallback(),this.render(),this.attachEventListeners()}disconnectedCallback(){super.disconnectedCallback(),this.detachEventListeners()}render(){let{theme:e,placeholder:n,showTrigger:r}=this.config;this.shadowRoot.innerHTML=`
            <style>${ze}</style>

            <!-- Trigger button -->
            <button class="sm-trigger" part="trigger" aria-label="Open search" ${r?"":'style="display: none;"'}>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
                <span class="sm-trigger-text">Search</span>
                <kbd class="sm-trigger-kbd" aria-hidden="true">${this.getHotkeyDisplay()}</kbd>
            </button>

            <!-- Modal backdrop -->
            <div class="sm-backdrop" part="backdrop" hidden>
                <div class="sm-modal" part="modal" role="dialog" aria-modal="true" aria-label="Search">
                    <!-- Search input -->
                    <div class="sm-header" part="header">
                        <svg class="sm-search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                        <input
                            type="text"
                            id="${this.inputId}"
                            class="sm-input"
                            part="input"
                            placeholder="${n}"
                            maxlength="256"
                            autocomplete="off"
                            autocorrect="off"
                            autocapitalize="off"
                            spellcheck="false"
                            role="combobox"
                            aria-autocomplete="list"
                            aria-haspopup="listbox"
                            aria-expanded="false"
                            aria-controls="${this.listboxId}"
                        />
                        <div class="sm-loading" part="loading" hidden>
                            <svg class="sm-spinner" width="20" height="20" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" opacity="0.25"/>
                                <path d="M12 2a10 10 0 0 1 10 10" stroke="currentColor" stroke-width="3" fill="none" stroke-linecap="round"/>
                            </svg>
                        </div>
                        <button class="sm-close" part="close" aria-label="Close search">
                            <kbd>esc</kbd>
                        </button>
                    </div>

                    <!-- Results -->
                    <div class="sm-results" part="results" id="${this.listboxId}" role="listbox" aria-label="Search results"></div>

                    <!-- Debug toolbar (sticky at bottom) -->
                    <div class="sm-debug-toolbar" part="debug-toolbar" hidden></div>

                    <!-- Footer -->
                    <div class="sm-footer" part="footer">
                        <div class="sm-footer-hints">
                            <span><kbd>\u2191</kbd><kbd>\u2193</kbd> navigate</span>
                            <span><kbd>\u21B5</kbd> select</span>
                            <span><kbd>esc</kbd> close</span>
                        </div>
                        <div class="sm-footer-brand">
                            Powered by <strong>Search Manager</strong>
                        </div>
                    </div>
                </div>
            </div>
        `,this.elements={trigger:this.shadowRoot.querySelector(".sm-trigger"),backdrop:this.shadowRoot.querySelector(".sm-backdrop"),modal:this.shadowRoot.querySelector(".sm-modal"),input:this.shadowRoot.querySelector(".sm-input"),results:this.shadowRoot.querySelector(".sm-results"),loading:this.shadowRoot.querySelector(".sm-loading"),close:this.shadowRoot.querySelector(".sm-close"),debugToolbar:this.shadowRoot.querySelector(".sm-debug-toolbar")},this.initializeLiveRegion(),this.shadowRoot.host.setAttribute("data-theme",e),this.applyCustomStyles()}getResultsContainer(){return this.elements.results}getInputElement(){return this.elements.input}getLoadingElement(){return this.elements.loading}applyCustomStyles(){if(super.applyCustomStyles(),!this.config)return;let{backdropOpacity:e,enableBackdropBlur:n}=this.config,r=this.shadowRoot.host;r.style.setProperty("--sm-backdrop-opacity",e/100),r.style.setProperty("--sm-backdrop-blur",n?"blur(4px)":"none")}attachEventListeners(){this.elements.trigger.addEventListener("click",this.toggle),this.elements.close.addEventListener("click",this.close),this.elements.backdrop.addEventListener("click",this.handleBackdropClick),this.elements.input.addEventListener("input",this.handleInput),this.elements.input.addEventListener("keydown",this.handleKeydown),document.addEventListener("keydown",this.handleGlobalKeydown);let{triggerSelector:e}=this.config;e&&(this.externalTrigger=document.querySelector(e),this.externalTrigger&&this.externalTrigger.addEventListener("click",this.toggle))}detachEventListeners(){document.removeEventListener("keydown",this.handleGlobalKeydown),this.externalTrigger&&(this.externalTrigger.removeEventListener("click",this.toggle),this.externalTrigger=null)}open(){this.state.set({isOpen:!0}),this.elements.backdrop.hidden=!1,this.elements.input.value="",this.state.set({query:"",results:[],selectedIndex:-1}),this.renderResultsContent(),requestAnimationFrame(()=>{this.elements.input.focus()}),this.config.preventBodyScroll&&(document.body.style.overflow="hidden"),this.dispatchWidgetEvent("open",{source:"programmatic"})}close(){this.state.set({isOpen:!1}),this.elements.backdrop.hidden=!0,this.config.preventBodyScroll&&(document.body.style.overflow=""),this.resetAnalyticsTracking(),this.dispatchWidgetEvent("close")}toggle(){this.state.get("isOpen")?this.close():this.open()}handleGlobalKeydown(e){let n=this.config.hotkey.toLowerCase();(navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey:e.ctrlKey)&&e.key.toLowerCase()===n&&(e.preventDefault(),this.toggle()),e.key==="Escape"&&this.state.get("isOpen")&&(e.preventDefault(),this.close())}handleEscape(){this.close()}handleBackdropClick(e){e.target===this.elements.backdrop&&this.close()}onResultSelected(e,n,r){this.close()}getHotkeyDisplay(){let e=navigator.platform.toUpperCase().indexOf("MAC")>=0,n=this.config.hotkey.toUpperCase();return e?`\u2318${n}`:`Ctrl+${n}`}},qe=P;return Te(We);})();
if(typeof customElements!=='undefined'&&!customElements.get('search-modal')){customElements.define('search-modal',SearchModalWidget.default);}
